(()=>{var e={};e.id=879,e.ids=[879],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4196:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>h,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>l});var o={};r.r(o),r.d(o,{GET:()=>d});var a=r(2706),s=r(8203),n=r(5994),c=r(9187);let i=process.env.BACKEND_URL||"http://localhost:3000";async function d(e,{params:t}){let{batchId:r}=await t;if(!r)return c.NextResponse.json({error:"Batch ID is required"},{status:400});try{let e=`${i}/api/v1/scraping-batch/${r}/stream`;console.log(`📡 Proxying SSE request to: ${e}`);let t=new TextEncoder,o=new ReadableStream({async start(r){try{let o=await fetch(e,{method:"GET",headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}});if(!o.ok)throw Error(`Backend responded with status: ${o.status}`);if(!o.body)throw Error("No response body from backend");let a=o.body.getReader(),s=new TextDecoder;for(;;){let{done:e,value:o}=await a.read();if(e){console.log("✅ SSE stream ended"),r.close();break}let n=s.decode(o,{stream:!0});r.enqueue(t.encode(n))}}catch(o){console.error("❌ SSE Proxy Error:",o);let e=`event: error
data: ${JSON.stringify({message:o.message||"Stream connection failed"})}

`;r.enqueue(t.encode(e)),r.close()}}});return new c.NextResponse(o,{headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache, no-transform",Connection:"keep-alive","X-Accel-Buffering":"no"}})}catch(e){return console.error("❌ Error creating SSE proxy:",e),c.NextResponse.json({error:e.message||"Failed to connect to backend stream"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/v1/scraping-batch/[batchId]/stream/route",pathname:"/api/v1/scraping-batch/[batchId]/stream",filename:"route",bundlePath:"app/api/v1/scraping-batch/[batchId]/stream/route"},resolvedPagePath:"C:\\Users\\dilan\\Documents\\GitHub\\Web-Scrapping-Frontend2\\src\\app\\api\\v1\\scraping-batch\\[batchId]\\stream\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:u,workUnitAsyncStorage:l,serverHooks:h}=p;function m(){return(0,n.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:l})}},6487:()=>{},8335:()=>{}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[989,452],()=>r(4196));module.exports=o})();